{
  "db_name": "PostgreSQL",
  "query": "\n        WITH threshholded_users_achievements AS (\n            SELECT\n                users_achievements_completed.username,\n                id\n            FROM\n                users_achievements_completed\n            JOIN\n                (SELECT username FROM users_achievements_completed GROUP BY username HAVING count(*) >= $1) threshholded_users\n            ON\n                users_achievements_completed.username = threshholded_users.username\n        ), achievements_percent AS (\n            SELECT\n                id,\n                COUNT(*)::float / (\n                    SELECT COUNT(*) FROM users WHERE EXISTS (\n                        SELECT * FROM threshholded_users_achievements WHERE users.username = threshholded_users_achievements.username\n                    )\n                ) percent\n            FROM\n                threshholded_users_achievements\n            GROUP BY\n                id\n        )\n        INSERT INTO\n            achievements_percent(id, percent)\n        SELECT\n            achievements.id,\n            COALESCE(percent, 0)\n        FROM \n            achievements\n        LEFT JOIN\n            achievements_percent\n        ON\n            achievements.id = achievements_percent.id\n        ",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Int8"
      ]
    },
    "nullable": []
  },
  "hash": "c751fa4a03ee7b0183ae2932955846796bbdd97d25343e4408450a41346da2a8"
}
